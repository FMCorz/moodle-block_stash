define(["jquery"],function(a){function b(a){this._drop=a}return b.prototype.IMAGE="image",b.prototype.IMAGEANDBUTTON="imageandbutton",b.prototype.TEXT="text",b.prototype._actionText=null,b.prototype._displayType=b.prototype.IMAGEANDBUTTON,b.prototype._label=null,b.prototype._getActionText=function(){return null===this._actionText||""===this._actionText.trim()?this.getDefaultActionText():this._actionText},b.prototype._getAnchor=function(){return a('<a href="#"></a>')},b.prototype.getDefaultActionText=function(){return"Pick up!"},b.prototype.getDefaultLabel=function(){return"Pick up '"+this.getItem().get("name")+"'"},b.prototype._getDisplayButton=function(){var b=a('<div class="item-action"></div>'),c=a('<button class="btn btn-secondary"></button>');return c.text(this._getActionText()),b.append(c),b},b.prototype._getDisplayImage=function(){var b=a('<div class="item-image"></div>'),c=a('<div class="item-label"></div>');return b.addClass("item-image"),b.css("backgroundImage","url("+this.getItem().get("imageurl")+")"),c.text(this.getItem().get("name")),c.attr("title",this.getItem().get("name")),b.append(c),b},b.prototype.getDrop=function(){return this._drop},b.prototype.getDisplay=function(){return this._getDisplayType(this._displayType)},b.prototype._getDisplayType=function(b){var c,d;return b==this.IMAGE?(c=a('<div class="block-stash-item"></div>'),d=this._getAnchor(),d.append(this._getDisplayImage()),c.append(d)):b==this.IMAGEANDBUTTON?(c=a('<div class="block-stash-item"></div>'),c.append(this._getDisplayImage()),c.append(this._getDisplayButton())):(c=a("<span></span>"),d=this._getAnchor(),d.text(this._getLabel()),c.append(d)),c},b.prototype.getItem=function(){return this._drop.getItem()},b.prototype._getLabel=function(){return null===this._label||""===this._label.trim()?this.getDefaultLabel():this._label},b.prototype.getSnippet=function(){var b=a("<div>"),c=this.uuid(),d=a('<span id="'+c+'">'),e=a('<script type="text/javascript">'),f=this.getDrop().get("id"),g=this.getDrop().get("hashcode"),h=this.getDisplay(),i="";return i='require(["jquery", "block_stash/drop"], function($, D) { var d = new D({id: '+f+', hashcode: "'+g+'"}), n = $("#'+c+'"); if (!n.length) return; n.removeClass(); d.isVisible().then(function() { n.show(); }); n.find("a, button").click(function(e) { e.preventDefault(); d.pickup(); n.remove(); });})',i=this._wrapForOnReady(i),b.append(d),d.css("display","none"),d.append(h),d.append(e),e.html(i),b.html()},b.prototype.setDisplayType=function(a){this._displayType=a},b.prototype.setActionText=function(a){this._actionText=a},b.prototype.setLabel=function(a){this._label=a},b.prototype.uuid=function(){return Math.random().toString(36).substring(2,7)+(new Date).getTime().toString(36)},b.prototype._wrapForOnReady=function(a){return'document.addEventListener("DOMContentLoaded", function(e) {'+a+"});"},b});